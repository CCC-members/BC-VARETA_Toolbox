
%% Get T from BC-VARETA results

clear all;
close all;
clc;
disp('-->> Starting process.')

BCV_output_path = "E:\OneDrive - CCLab\PRE\BC-V_Output\FE0004A\Activation_level\sSSBLpp";
output_path = "E:\OneDrive - CCLab\PRE\BC-V_Output\";

MEEG_files = dir(fullfile(BCV_output_path,'**','MEEG_source*'));

binds = [0.1 0.406 0.712 1.018 1.63 1.324 1.936 2 ...
    2.1 2.406 2.712 3.018 3.63 3.324 3.936 4.242 4.548 4.854 5.16 5.466 5.772 6 ...
    6.1 6.406 6.712 7.018 7.324 7.63 7.936 8.242 8.548 8.854 9.16 9.466 9.772 10.078 10.384 10.69 10.996 11.302 11.608 11.914 12 ...
    12.1 12.406 12.712 13.018 13.324 13.63 13.936 14.242 14.548 14.854 15.16 15.466 15.772 16.078 16.384 16.69 16.996 17.302 ...
    17.608 17.914 18.22 18.526 18.832 19.138 19.444 19.75 20.056 20.362 20.668 20.974 21.28 21.586 21.892 22.198 22.504 22.81 ...
    23.116 23.422 23.728 24.034 24.34 24.646 24.952 25.258 25.564 25.87 26.176 26.482 26.788 27.094 27.4 27.706 28.012 28.318 28.624 28.93 ...
    29.236 29.542 29.848 30.154 30.46 30.766 31 ...
    32 31.306 31.612 31.918 32.224 32.53 32.836 33.142 33.448 33.754 34.06 34.366 34.672 34.978 35.284 35.59 35.896 36.202 36.508 36.814 ...
    37.12 37.426 37.732 38.038 38.344 38.65 38.956 39.262 39.568 39.874 40.18 40.486 40.792 41.098 41.404 41.71 42.016 42.322 42.628 42.934 ...
    43.24 43.546 43.852 44.158 44.464 44.77 45.076 45.382 45.688 45.994 46.3 46.606 46.912 47.218 47.524 47.83 48.136 48.442 48.748 49.054 49.36 49.666 49.972 50];

tensor_T_freq = zeros(24003,19,2,length(binds));
for i=1:length(MEEG_files)
    file = MEEG_files(i);
    file_name = file.name;
    disp(strcat("-->> Loading file: ",file_name));
    full_name = fullfile(file.folder,file.name);
    load(full_name,'T');
    name_parts = split(file_name,'_');
    band = name_parts(4);
    bin = split(name_parts(4),'Hz.mat');
    bin = bin{1};
    ind = find(binds == str2double(bin));
    tensor_T_freq(:,:,:,ind) = T;
end
   
disp('-->> Process finished.');